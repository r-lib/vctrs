<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • vctrs</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.2/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.2/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><meta property="og:image" content="https://vctrs.r-lib.org/logo.png"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="vctrs.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vctrs</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.4.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/pillar.html">Printing vectors nicely in tibbles</a>
    <a class="dropdown-item" href="../articles/s3-vector.html">S3 vectors</a>
    <a class="dropdown-item" href="../articles/stability.html">Type and size stability</a>
    <a class="dropdown-item" href="../articles/type-size.html">Prototypes and sizes</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-lib/vctrs/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-news" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Changelog</h1>
      <small>Source: <a href="https://github.com/r-lib/vctrs/blob/HEAD/NEWS.md" class="external-link"><code>NEWS.md</code></a></small>
    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="development version" id="vctrs-development-version">vctrs (development version)<a class="anchor" aria-label="anchor" href="#vctrs-development-version"></a></h2>
<ul><li><p>The experimental <code>n</code> argument of <code><a href="../reference/vec_proxy.html">vec_restore()</a></code> has been removed. It was only used to inform on the size of data frames in case a bare list is restored. It is now expected that bare lists be initialised to data frame so that the size is carried through row attributes. This makes the generic simpler and fixes some performance issues (<a href="https://github.com/r-lib/vctrs/issues/650" class="external-link">#650</a>).</p></li>
<li><p>The <code><a href="https://rdrr.io/r/base/NA.html" class="external-link">anyNA()</a></code> method for <code>vctrs_vctr</code> (and thus <code>vctrs_list_of</code>) now supports the <code>recursive</code> argument (<a href="https://github.com/r-lib/vctrs/issues/1278" class="external-link">#1278</a>).</p></li>
<li><p><code><a href="../reference/vec_as_location.html">vec_as_location()</a></code> and <code><a href="../reference/vec_as_location.html">num_as_location()</a></code> have gained a <code>missing = "remove"</code> option (<a href="https://github.com/r-lib/vctrs/issues/1595" class="external-link">#1595</a>).</p></li>
<li><p><code><a href="../reference/vec_as_location.html">vec_as_location()</a></code> no longer matches <code>NA_character_</code> and <code>""</code> indices if those invalid names appear in <code>names</code> (<a href="https://github.com/r-lib/vctrs/issues/1489" class="external-link">#1489</a>).</p></li>
<li><p><code><a href="../reference/vec_unchop.html">vec_unchop()</a></code> has been renamed to <code><a href="../reference/vec_chop.html">list_unchop()</a></code> to better indicate that it requires list input. <code><a href="../reference/vec_unchop.html">vec_unchop()</a></code> will stick around for a few minor versions, but has been formally soft-deprecated (<a href="https://github.com/r-lib/vctrs/issues/1209" class="external-link">#1209</a>).</p></li>
<li><p>Lossy cast errors during scalar subscript validation now have the correct message (<a href="https://github.com/r-lib/vctrs/issues/1606" class="external-link">#1606</a>).</p></li>
<li><p>Fixed confusing error message with logical <code>[[</code> subscripts (<a href="https://github.com/r-lib/vctrs/issues/1608" class="external-link">#1608</a>).</p></li>
<li><p>New <code><a href="../reference/vec_rank.html">vec_rank()</a></code> to compute various types of sample ranks (<a href="https://github.com/r-lib/vctrs/issues/1600" class="external-link">#1600</a>).</p></li>
<li><p><code><a href="../reference/vec_as_location.html">num_as_location()</a></code> now throws the right error when there are out-of-bounds negative values and <code>oob = "extend"</code> and <code>negative = "ignore"</code> are set (<a href="https://github.com/r-lib/vctrs/issues/1614" class="external-link">#1614</a>, <a href="https://github.com/r-lib/vctrs/issues/1630" class="external-link">#1630</a>).</p></li>
<li><p><code><a href="../reference/vec_as_location.html">num_as_location()</a></code> now works correctly when a combination of <code>zero = "error"</code> and <code>negative = "invert"</code> are used (<a href="https://github.com/r-lib/vctrs/issues/1612" class="external-link">#1612</a>).</p></li>
<li><p><code><a href="../reference/data_frame.html">data_frame()</a></code> and <code><a href="../reference/df_list.html">df_list()</a></code> have gained <code>.call</code> arguments (<a href="https://github.com/r-lib/vctrs/issues/1610" class="external-link">#1610</a>).</p></li>
<li><p><code><a href="../reference/vec_locate_matches.html">vec_locate_matches()</a></code> has gained a <code>call</code> argument (<a href="https://github.com/r-lib/vctrs/issues/1611" class="external-link">#1611</a>).</p></li>
<li><p><code>"select"</code> and <code>"relocate"</code> have been added as valid subscript actions to support tidyselect and dplyr (<a href="https://github.com/r-lib/vctrs/issues/1596" class="external-link">#1596</a>).</p></li>
<li><p><code><a href="../reference/vec_as_location.html">num_as_location()</a></code> has a new <code>oob = "remove"</code> argument to remove out-of-bounds locations (<a href="https://github.com/r-lib/vctrs/issues/1595" class="external-link">#1595</a>).</p></li>
<li><p><code><a href="../reference/vec_bind.html">vec_rbind()</a></code> and <code><a href="../reference/vec_bind.html">vec_cbind()</a></code> now have <code>.call</code> arguments (<a href="https://github.com/r-lib/vctrs/issues/1597" class="external-link">#1597</a>).</p></li>
<li><p><code><a href="../reference/df_list.html">df_list()</a></code> has gained a new <code>.unpack</code> argument to optionally disable data frame unpacking (<a href="https://github.com/r-lib/vctrs/issues/1616" class="external-link">#1616</a>).</p></li>
<li><p><code>vec_check_list(arg = "")</code> now throws the correct error (<a href="https://github.com/r-lib/vctrs/issues/1604" class="external-link">#1604</a>).</p></li>
<li><p>The <code>difftime</code> to <code>difftime</code> <code><a href="../reference/vec_cast.html">vec_cast()</a></code> method now standardizes the internal storage type to double, catching potentially corrupt integer storage <code>difftime</code> vectors (<a href="https://github.com/r-lib/vctrs/issues/1602" class="external-link">#1602</a>).</p></li>
<li><p><code><a href="../reference/vec_as_location.html">vec_as_location2()</a></code> and <code><a href="../reference/vec_as_subscript.html">vec_as_subscript2()</a></code> more correctly utilize their <code>call</code> arguments (<a href="https://github.com/r-lib/vctrs/issues/1605" class="external-link">#1605</a>).</p></li>
<li><p><code>vec_count(sort = "count")</code> now uses a stable sorting method. This ensures that different keys with the same count are sorted in the order that they originally appeared in (<a href="https://github.com/r-lib/vctrs/issues/1588" class="external-link">#1588</a>).</p></li>
<li><p>Lossy cast error conditions now show the correct message when <code><a href="https://rdrr.io/r/base/conditions.html" class="external-link">conditionMessage()</a></code> is called on them (<a href="https://github.com/r-lib/vctrs/issues/1592" class="external-link">#1592</a>).</p></li>
<li><p>Fixed inconsistent reporting of conflicting inputs in <code><a href="../reference/vec_ptype.html">vec_ptype_common()</a></code> (<a href="https://github.com/r-lib/vctrs/issues/1570" class="external-link">#1570</a>).</p></li>
<li><p><code><a href="../reference/vec_ptype_full.html">vec_ptype_abbr()</a></code> and <code><a href="../reference/vec_ptype_full.html">vec_ptype_full()</a></code> now suffix 1d arrays with <code>[1d]</code>.</p></li>
<li><p><code><a href="../reference/vec_ptype_full.html">vec_ptype_abbr()</a></code> and <code><a href="../reference/vec_ptype_full.html">vec_ptype_full()</a></code> methods are no longer inherited (<a href="https://github.com/r-lib/vctrs/issues/1549" class="external-link">#1549</a>).</p></li>
<li><p><code><a href="../reference/vec_cast.html">vec_cast()</a></code> now throws the correct error when attempting to cast a subclassed data frame to a non-data frame type (<a href="https://github.com/r-lib/vctrs/issues/1568" class="external-link">#1568</a>).</p></li>
<li><p><code><a href="../reference/vec_locate_matches.html">vec_locate_matches()</a></code> now uses a more conservative heuristic when taking the joint ordering proxy. This allows it to work correctly with sf’s sfc vectors and the classes from the bignum package (<a href="https://github.com/r-lib/vctrs/issues/1558" class="external-link">#1558</a>).</p></li>
<li><p>An sfc method for <code><a href="../reference/vec_proxy_compare.html">vec_proxy_order()</a></code> was added to better support the sf package. These vectors are generally treated like list-columns even though they don’t explicitly have a <code>"list"</code> class, and the <code><a href="../reference/vec_proxy_compare.html">vec_proxy_order()</a></code> method now forwards to the list method to reflect that (<a href="https://github.com/r-lib/vctrs/issues/1558" class="external-link">#1558</a>).</p></li>
<li><p><code><a href="../reference/vec_proxy_compare.html">vec_proxy_compare()</a></code> now works correctly for raw vectors wrapped in <code><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I()</a></code>. <code><a href="../reference/vec_proxy_compare.html">vec_proxy_order()</a></code> now works correctly for raw and list vectors wrapped in <code><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I()</a></code> (<a href="https://github.com/r-lib/vctrs/issues/1557" class="external-link">#1557</a>).</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.4.1" id="vctrs-041">vctrs 0.4.1<a class="anchor" aria-label="anchor" href="#vctrs-041"></a></h2><p class="text-muted">CRAN release: 2022-04-13</p>
<ul><li><p>OOB errors with <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> indexes use “that don’t exist” instead of “past the end” (<a href="https://github.com/r-lib/vctrs/issues/1543" class="external-link">#1543</a>).</p></li>
<li><p>Fixed memory protection issues related to common type determination (<a href="https://github.com/r-lib/vctrs/issues/1551" class="external-link">#1551</a>, tidyverse/tidyr#1348).</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.4.0" id="vctrs-040">vctrs 0.4.0<a class="anchor" aria-label="anchor" href="#vctrs-040"></a></h2><p class="text-muted">CRAN release: 2022-03-30</p>
<ul><li><p>New experimental <code><a href="../reference/vec_locate_sorted_groups.html">vec_locate_sorted_groups()</a></code> for returning the locations of groups in sorted order. This is equivalent to, but faster than, calling <code><a href="../reference/vec_group.html">vec_group_loc()</a></code> and then sorting by the <code>key</code> column of the result.</p></li>
<li><p>New experimental <code><a href="../reference/vec_locate_matches.html">vec_locate_matches()</a></code> for locating where each observation in one vector matches one or more observations in another vector. It is similar to <code><a href="../reference/vec_match.html">vec_match()</a></code>, but returns all matches by default (rather than just the first), and can match on binary conditions other than equality. The algorithm is inspired by data.table’s very fast binary merge procedure.</p></li>
<li><p>The <code><a href="../reference/vec_proxy_equal.html">vec_proxy_equal()</a></code>, <code><a href="../reference/vec_proxy_compare.html">vec_proxy_compare()</a></code>, and <code><a href="../reference/vec_proxy_compare.html">vec_proxy_order()</a></code> methods for <code>vctrs_rcrd</code> are now applied recursively over the fields (<a href="https://github.com/r-lib/vctrs/issues/1503" class="external-link">#1503</a>).</p></li>
<li><p>Lossy cast errors now inherit from incompatible type errors.</p></li>
<li><p><code><a href="../reference/vec_is_list.html">vec_is_list()</a></code> now returns <code>TRUE</code> for <code>AsIs</code> lists (<a href="https://github.com/r-lib/vctrs/issues/1463" class="external-link">#1463</a>).</p></li>
<li>
<p><code><a href="../reference/vec_assert.html">vec_assert()</a></code>, <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code>, <code><a href="../reference/vec_cast.html">vec_cast()</a></code>, and <code><a href="../reference/vec_as_location.html">vec_as_location()</a></code> now use <code>caller_arg()</code> to infer a default <code>arg</code> value from the caller.</p>
<p>This may result in unhelpful arguments being mentioned in error messages. In general, you should consider snapshotting vctrs error messages thrown in your package and supply <code>arg</code> and <code>call</code> arguments if the error context is not adequately reported to your users.</p>
</li>
<li><p><code><a href="../reference/vec_ptype.html">vec_ptype_common()</a></code>, <code><a href="../reference/vec_cast.html">vec_cast_common()</a></code>, <code><a href="../reference/vec_size.html">vec_size_common()</a></code>, and <code><a href="../reference/vec_recycle.html">vec_recycle_common()</a></code> gain <code>call</code> and <code>arg</code> arguments for specifying an error context.</p></li>
<li><p><code><a href="../reference/vec_compare.html">vec_compare()</a></code> can now compare zero column data frames (<a href="https://github.com/r-lib/vctrs/issues/1500" class="external-link">#1500</a>).</p></li>
<li><p><code><a href="../reference/new_data_frame.html">new_data_frame()</a></code> now errors on negative and missing <code>n</code> values (<a href="https://github.com/r-lib/vctrs/issues/1477" class="external-link">#1477</a>).</p></li>
<li><p><code><a href="../reference/vec_order.html">vec_order()</a></code> now correctly orders zero column data frames (<a href="https://github.com/r-lib/vctrs/issues/1499" class="external-link">#1499</a>).</p></li>
<li><p>vctrs now depends on cli to help with error message generation.</p></li>
<li><p>New <code><a href="../reference/vec_is_list.html">vec_check_list()</a></code> and <code><a href="../reference/vec_is_list.html">list_check_all_vectors()</a></code> input checkers, and an accompanying <code><a href="../reference/vec_is_list.html">list_all_vectors()</a></code> predicate.</p></li>
<li><p>New <code><a href="../reference/vec_interleave.html">vec_interleave()</a></code> for combining multiple vectors together, interleaving their elements in the process (<a href="https://github.com/r-lib/vctrs/issues/1396" class="external-link">#1396</a>).</p></li>
<li><p><code>vec_equal_na(NULL)</code> now returns <code>logical(0)</code> rather than erroring (<a href="https://github.com/r-lib/vctrs/issues/1494" class="external-link">#1494</a>).</p></li>
<li><p><code>vec_as_location(missing = "error")</code> now fails with <code>NA</code> and <code>NA_character_</code> in addition to <code>NA_integer_</code> (<a href="https://github.com/r-lib/vctrs/issues/1420" class="external-link">#1420</a>, <a href="https://github.com/krlmlr" class="external-link">@krlmlr</a>).</p></li>
<li>
<p>Starting with rlang 1.0.0, errors are displayed with the contextual function call. Several vctrs operations gain a <code>call</code> argument that makes it possible to report the correct context in error messages. This concerns:</p>
<ul><li>
<code><a href="../reference/vec_cast.html">vec_cast()</a></code> and <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code>
</li>
<li>
<code><a href="../reference/vec_default_ptype2.html">vec_default_cast()</a></code> and <code><a href="../reference/vec_default_ptype2.html">vec_default_ptype2()</a></code>
</li>
<li><code><a href="../reference/vec_assert.html">vec_assert()</a></code></li>
<li><code><a href="../reference/vec_as_names.html">vec_as_names()</a></code></li>
<li>
<code>stop_</code> constructors like <code><a href="../reference/vctrs-conditions.html">stop_incompatible_type()</a></code>
</li>
</ul><p>Note that default <code><a href="../reference/vec_cast.html">vec_cast()</a></code> and <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> methods automatically support this if they pass <code>...</code> to the corresponding <code>vec_default_</code> functions. If you throw a non-internal error from a non-default method, add a <code>call = caller_env()</code> argument in the method and pass it to <code><a href="https://rlang.r-lib.org/reference/abort.html" class="external-link">rlang::abort()</a></code>.</p>
</li>
<li><p>If <code>NA_character_</code> is specified as a name for <code>vctrs_vctr</code> objects, it is now automatically repaired to <code>""</code> (<a href="https://github.com/r-lib/vctrs/issues/780" class="external-link">#780</a>).</p></li>
<li><p><code>""</code> is now an allowed name for <code>vctrs_vctr</code> objects and all its subclasses (<code>vctrs_list_of</code> in particular) (<a href="https://github.com/r-lib/vctrs/issues/780" class="external-link">#780</a>).</p></li>
<li><p><code><a href="../reference/list_of.html">list_of()</a></code> is now much faster when many values are provided.</p></li>
<li><p><code><a href="../reference/vec_as_location.html">vec_as_location()</a></code> evaluates <code>arg</code> only in case of error, for performance (<a href="https://github.com/r-lib/vctrs/issues/1150" class="external-link">#1150</a>, <a href="https://github.com/krlmlr" class="external-link">@krlmlr</a>).</p></li>
<li><p><code>levels.vctrs_vctr()</code> now returns <code>NULL</code> instead of failing (<a href="https://github.com/r-lib/vctrs/issues/1186" class="external-link">#1186</a>, <a href="https://github.com/krlmlr" class="external-link">@krlmlr</a>).</p></li>
<li><p><code><a href="../reference/vec_assert.html">vec_assert()</a></code> produces a more informative error when <code>size</code> is invalid (<a href="https://github.com/r-lib/vctrs/issues/1470" class="external-link">#1470</a>).</p></li>
<li><p><code><a href="../reference/vec_duplicate.html">vec_duplicate_detect()</a></code> is a bit faster when there are many unique values.</p></li>
<li><p><code><a href="../reference/vec_proxy_compare.html">vec_proxy_order()</a></code> is described in <code>vignette("s3-vectors")</code> (<a href="https://github.com/r-lib/vctrs/issues/1373" class="external-link">#1373</a>, <a href="https://github.com/krlmlr" class="external-link">@krlmlr</a>).</p></li>
<li><p><code><a href="../reference/vec_chop.html">vec_chop()</a></code> now materializes ALTREP vectors before chopping, which is more efficient than creating many small ALTREP pieces (<a href="https://github.com/r-lib/vctrs/issues/1450" class="external-link">#1450</a>).</p></li>
<li><p>New <code><a href="../reference/list_drop_empty.html">list_drop_empty()</a></code> for removing empty elements from a list (<a href="https://github.com/r-lib/vctrs/issues/1395" class="external-link">#1395</a>).</p></li>
<li><p><code><a href="../reference/vec_size.html">list_sizes()</a></code> now propagates the names of the list onto the result.</p></li>
<li><p>Name repair messages are now signaled by <code><a href="https://rlang.r-lib.org/reference/names_inform_repair.html" class="external-link">rlang::names_inform_repair()</a></code>. This means that the messages are now sent to stdout by default rather than to stderr, resulting in prettier messages. Additionally, name repair messages can now be silenced through the global option <code>rlib_name_repair_verbosity</code>, which is useful for testing purposes. See <code>?names_inform_repair</code> for more information (<a href="https://github.com/r-lib/vctrs/issues/1429" class="external-link">#1429</a>).</p></li>
<li><p><code>vctrs_vctr</code> methods for <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit()</a></code>, <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.exclude()</a></code>, and <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.fail()</a></code> have been added (<a href="https://github.com/r-lib/vctrs/issues/1413" class="external-link">#1413</a>).</p></li>
<li><p><code><a href="../reference/vec_init.html">vec_init()</a></code> is now slightly faster (<a href="https://github.com/r-lib/vctrs/issues/1423" class="external-link">#1423</a>).</p></li>
<li><p><code><a href="../reference/vec_names.html">vec_set_names()</a></code> no longer corrupts <code>vctrs_rcrd</code> types (<a href="https://github.com/r-lib/vctrs/issues/1419" class="external-link">#1419</a>).</p></li>
<li><p><code><a href="../reference/vec_detect_complete.html">vec_detect_complete()</a></code> now computes completeness for <code>vctrs_rcrd</code> types in the same way as data frames, which means that if any field is missing, the entire record is considered incomplete (<a href="https://github.com/r-lib/vctrs/issues/1386" class="external-link">#1386</a>).</p></li>
<li><p>The <code>na_value</code> argument of <code><a href="../reference/vec_order.html">vec_order()</a></code> and <code><a href="../reference/vec_order.html">vec_sort()</a></code> now correctly respect missing values in lists (<a href="https://github.com/r-lib/vctrs/issues/1401" class="external-link">#1401</a>).</p></li>
<li><p><code><a href="../reference/vec-rep.html">vec_rep()</a></code> and <code><a href="../reference/vec-rep.html">vec_rep_each()</a></code> are much faster for <code>times = 0</code> and <code>times = 1</code> (<a href="https://github.com/mgirlich" class="external-link">@mgirlich</a>, <a href="https://github.com/r-lib/vctrs/issues/1392" class="external-link">#1392</a>).</p></li>
<li><p><code><a href="../reference/vec_equal.html">vec_equal_na()</a></code> and <code><a href="../reference/vec_fill_missing.html">vec_fill_missing()</a></code> now work with integer64 vectors (<a href="https://github.com/r-lib/vctrs/issues/1304" class="external-link">#1304</a>).</p></li>
<li><p>The <code><a href="https://rdrr.io/r/base/xtfrm.html" class="external-link">xtfrm()</a></code> method for vctrs_vctr objects no longer accidentally breaks ties (<a href="https://github.com/r-lib/vctrs/issues/1354" class="external-link">#1354</a>).</p></li>
<li><p><code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min()</a></code>, <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max()</a></code> and <code><a href="https://rdrr.io/r/base/range.html" class="external-link">range()</a></code> no longer throw an error if <code>na.rm = TRUE</code> is set and all values are <code>NA</code> (<a href="https://github.com/gorcha" class="external-link">@gorcha</a>, <a href="https://github.com/r-lib/vctrs/issues/1357" class="external-link">#1357</a>). In this case, and where an empty input is given, it will return <code>Inf</code>/<code>-Inf</code>, or <code>NA</code> if <code>Inf</code> can’t be cast to the input type.</p></li>
<li><p><code><a href="../reference/vec_group.html">vec_group_loc()</a></code>, used for grouping in dplyr, now correctly handles vectors with billions of elements (up to <code>.Machine$integer.max</code>) (<a href="https://github.com/r-lib/vctrs/issues/1133" class="external-link">#1133</a>).</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.8" id="vctrs-038">vctrs 0.3.8<a class="anchor" aria-label="anchor" href="#vctrs-038"></a></h2><p class="text-muted">CRAN release: 2021-04-29</p>
<ul><li>Compatibility with next version of rlang.</li></ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.7" id="vctrs-037">vctrs 0.3.7<a class="anchor" aria-label="anchor" href="#vctrs-037"></a></h2><p class="text-muted">CRAN release: 2021-03-29</p>
<ul><li><p><code><a href="../reference/vec_ptype_full.html">vec_ptype_abbr()</a></code> gains arguments to control whether to indicate named vectors with a prefix (<code>prefix_named</code>) and indicate shaped vectors with a suffix (<code>suffix_shape</code>) (<a href="https://github.com/r-lib/vctrs/issues/781" class="external-link">#781</a>, <a href="https://github.com/krlmlr" class="external-link">@krlmlr</a>).</p></li>
<li><p><code><a href="../reference/vec_ptype.html">vec_ptype()</a></code> is now an optional <em>performance</em> generic. It is not necessary to implement, but if your class has a static prototype, you might consider implementing a custom <code><a href="../reference/vec_ptype.html">vec_ptype()</a></code> method that returns a constant to improve performance in some cases (such as common type imputation).</p></li>
<li><p>New <code><a href="../reference/vec_detect_complete.html">vec_detect_complete()</a></code>, inspired by <code><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">stats::complete.cases()</a></code>. For most vectors, this is identical to <code>!vec_equal_na()</code>. For data frames and matrices, this detects rows that only contain non-missing values.</p></li>
<li><p><code><a href="../reference/vec_order.html">vec_order()</a></code> can now order complex vectors (<a href="https://github.com/r-lib/vctrs/issues/1330" class="external-link">#1330</a>).</p></li>
<li><p>Removed dependency on digest in favor of <code><a href="https://rlang.r-lib.org/reference/hash.html" class="external-link">rlang::hash()</a></code>.</p></li>
<li><p>Fixed an issue where <code>vctrs_rcrd</code> objects were not being proxied correctly when used as a data frame column (<a href="https://github.com/r-lib/vctrs/issues/1318" class="external-link">#1318</a>).</p></li>
<li><p><code>register_s3()</code> is now licensed with the “unlicense” which makes it very clear that it’s fine to copy and paste into your own package (<a href="https://github.com/maxheld83" class="external-link">@maxheld83</a>, <a href="https://github.com/r-lib/vctrs/issues/1254" class="external-link">#1254</a>).</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.6" id="vctrs-036">vctrs 0.3.6<a class="anchor" aria-label="anchor" href="#vctrs-036"></a></h2><p class="text-muted">CRAN release: 2020-12-17</p>
<ul><li><p>Fixed an issue with tibble 3.0.0 where removing column names with <code>names(x) &lt;- NULL</code> is now deprecated (<a href="https://github.com/r-lib/vctrs/issues/1298" class="external-link">#1298</a>).</p></li>
<li><p>Fixed a GCC 11 issue revealed by CRAN checks.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.5" id="vctrs-035">vctrs 0.3.5<a class="anchor" aria-label="anchor" href="#vctrs-035"></a></h2><p class="text-muted">CRAN release: 2020-11-17</p>
<ul><li><p>New experimental <code><a href="../reference/vec_fill_missing.html">vec_fill_missing()</a></code> for filling in missing values with the previous or following value. It is similar to <code>tidyr::fill()</code>, but also works with data frames and has an additional <code>max_fill</code> argument to limit the number of sequential missing values to fill.</p></li>
<li><p>New <code><a href="../reference/vec-rep.html">vec_unrep()</a></code> to compress a vector with repeated values. It is very similar to run length encoding, and works nicely alongside <code><a href="../reference/vec-rep.html">vec_rep_each()</a></code> as a way to invert the compression.</p></li>
<li><p><code><a href="../reference/vec_bind.html">vec_cbind()</a></code> with only empty data frames now preserves the common size of the inputs in the result (<a href="https://github.com/r-lib/vctrs/issues/1281" class="external-link">#1281</a>).</p></li>
<li><p><code><a href="../reference/vec_c.html">vec_c()</a></code> now correctly returns a named result with named empty inputs (<a href="https://github.com/r-lib/vctrs/issues/1263" class="external-link">#1263</a>).</p></li>
<li><p>vctrs has been relicensed as MIT (<a href="https://github.com/r-lib/vctrs/issues/1259" class="external-link">#1259</a>).</p></li>
<li><p>Functions that make comparisons within a single vector, such as <code><a href="../reference/vec_unique.html">vec_unique()</a></code>, or between two vectors, such as <code><a href="../reference/vec_match.html">vec_match()</a></code>, now convert all character input to UTF-8 before making comparisons (<a href="https://github.com/r-lib/vctrs/issues/1246" class="external-link">#1246</a>).</p></li>
<li><p>New <code><a href="../reference/vec_identify_runs.html">vec_identify_runs()</a></code> which returns a vector of identifiers for the elements of <code>x</code> that indicate which run of repeated values they fall in (<a href="https://github.com/r-lib/vctrs/issues/1081" class="external-link">#1081</a>).</p></li>
<li><p>Fixed an encoding translation bug with lists containing data frames which have columns where <code><a href="../reference/vec_size.html">vec_size()</a></code> is different from the low level <code>Rf_length()</code> (<a href="https://github.com/r-lib/vctrs/issues/1233" class="external-link">#1233</a>).</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.4" id="vctrs-034">vctrs 0.3.4<a class="anchor" aria-label="anchor" href="#vctrs-034"></a></h2><p class="text-muted">CRAN release: 2020-08-29</p>
<ul><li>Fixed a GCC sanitiser error revealed by CRAN checks.</li></ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.3" id="vctrs-033">vctrs 0.3.3<a class="anchor" aria-label="anchor" href="#vctrs-033"></a></h2><p class="text-muted">CRAN release: 2020-08-27</p>
<ul><li><p>The <code>table</code> class is now implemented as a wrapper type that delegates its coercion methods. It used to be restricted to integer tables (<a href="https://github.com/r-lib/vctrs/issues/1190" class="external-link">#1190</a>).</p></li>
<li><p>Named one-dimensional arrays now behave consistently with simple vectors in <code><a href="../reference/vec_names.html">vec_names()</a></code> and <code><a href="../reference/vec_bind.html">vec_rbind()</a></code>.</p></li>
<li><p><code><a href="../reference/new_rcrd.html">new_rcrd()</a></code> now uses <code><a href="../reference/df_list.html">df_list()</a></code> to validate the fields. This makes it more flexible as the fields can now be of any type supported by vctrs, including data frames.</p></li>
<li><p>Thanks to the previous change the <code>[[</code> method of records now preserves list fields (<a href="https://github.com/r-lib/vctrs/issues/1205" class="external-link">#1205</a>).</p></li>
<li><p><code><a href="../reference/vec_data.html">vec_data()</a></code> now preserves data frames. This is consistent with the notion that data frames are a primitive vector type in vctrs. This shouldn’t affect code that uses <code>[[</code> and <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code> to manipulate the data. On the other hand, the vctrs primitives like <code><a href="../reference/vec_slice.html">vec_slice()</a></code> will now operate rowwise when <code><a href="../reference/vec_data.html">vec_data()</a></code> returns a data frame.</p></li>
<li><p><code>outer</code> is now passed unrecycled to name specifications. Instead, the return value is recycled (<a href="https://github.com/r-lib/vctrs/issues/1099" class="external-link">#1099</a>).</p></li>
<li>
<p>Name specifications can now return <code>NULL</code>. The names vector will only be allocated if the spec function returns non-<code>NULL</code> during the concatenation. This makes it possible to ignore outer names without having to create an empty names vector when there are no inner names:</p>
<pre><code><span><span class="va">zap_outer_spec</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">outer</span>, <span class="va">inner</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="fu">is_character</span><span class="op">(</span><span class="va">inner</span><span class="op">)</span><span class="op">)</span> <span class="va">inner</span></span>
<span></span>
<span><span class="co"># `NULL` names rather than a vector of ""</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/vec_c.html">vec_c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, .name_spec <span class="op">=</span> <span class="va">zap_outer_spec</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co"># Names are allocated when inner names exist</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/vec_c.html">vec_c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span>, .name_spec <span class="op">=</span> <span class="va">zap_outer_spec</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] ""  ""  "b"</span></span></code></pre>
</li>
<li><p>Fixed several performance issues in <code><a href="../reference/vec_c.html">vec_c()</a></code> and <code><a href="../reference/vec_unchop.html">vec_unchop()</a></code> with named vectors.</p></li>
<li><p>The restriction that S3 lists must have a list-based proxy to be considered lists by <code><a href="../reference/vec_is_list.html">vec_is_list()</a></code> has been removed (<a href="https://github.com/r-lib/vctrs/issues/1208" class="external-link">#1208</a>).</p></li>
<li><p>New performant <code><a href="../reference/data_frame.html">data_frame()</a></code> constructor for creating data frames in a way that follows tidyverse semantics. Among other things, inputs are recycled using tidyverse recycling rules, strings are never converted to factors, list-columns are easier to create, and unnamed data frame input is automatically spliced.</p></li>
<li><p>New <code><a href="../reference/df_list.html">df_list()</a></code> for safely and consistently constructing the data structure underlying a data frame, a named list of equal-length vectors. It is useful in combination with <code><a href="../reference/new_data_frame.html">new_data_frame()</a></code> for creating user-friendly constructors for data frame subclasses that use the tidyverse rules for recycling and determining types.</p></li>
<li><p>Fixed performance issue with <code><a href="../reference/vec_order.html">vec_order()</a></code> on classed vectors which affected <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">dplyr::group_by()</a></code> (tidyverse/dplyr#5423).</p></li>
<li><p><code><a href="../reference/vec_names.html">vec_set_names()</a></code> no longer alters the input in-place (<a href="https://github.com/r-lib/vctrs/issues/1194" class="external-link">#1194</a>).</p></li>
<li><p>New <code><a href="../reference/vec_proxy_compare.html">vec_proxy_order()</a></code> that provides an ordering proxy for use in <code><a href="../reference/vec_order.html">vec_order()</a></code> and <code><a href="../reference/vec_order.html">vec_sort()</a></code>. The default method falls through to <code><a href="../reference/vec_proxy_compare.html">vec_proxy_compare()</a></code>. Lists are special cased, and return an integer vector proxy that orders by first appearance.</p></li>
<li><p>List columns in data frames are no longer comparable through <code><a href="../reference/vec_compare.html">vec_compare()</a></code>.</p></li>
<li><p>The experimental <code>relax</code> argument has been removed from <code><a href="../reference/vec_proxy_compare.html">vec_proxy_compare()</a></code>.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.2" id="vctrs-032">vctrs 0.3.2<a class="anchor" aria-label="anchor" href="#vctrs-032"></a></h2><p class="text-muted">CRAN release: 2020-07-15</p>
<ul><li><p>Fixed a performance issue in <code>bind_rows()</code> with S3 columns (<a href="https://github.com/r-lib/vctrs/issues/1122" class="external-link">#1122</a>, <a href="https://github.com/r-lib/vctrs/issues/1124" class="external-link">#1124</a>, <a href="https://github.com/r-lib/vctrs/issues/1151" class="external-link">#1151</a>, tidyverse/dplyr#5327).</p></li>
<li><p><code><a href="../reference/vec_slice.html">vec_slice()</a></code> now checks sizes of data frame columns in case the data structure is corrupt (<a href="https://github.com/r-lib/vctrs/issues/552" class="external-link">#552</a>).</p></li>
<li><p>The native routines in vctrs now dispatch and evaluate in the vctrs namespace. This improves the continuity of evaluation in backtraces.</p></li>
<li><p><code><a href="../reference/new_data_frame.html">new_data_frame()</a></code> is now twice as fast when <code>class</code> is supplied.</p></li>
<li><p>New <code><a href="../reference/vec_names.html">vec_names2()</a></code>, <code><a href="../reference/vec_names.html">vec_names()</a></code> and <code><a href="../reference/vec_names.html">vec_set_names()</a></code> (<a href="https://github.com/r-lib/vctrs/issues/1173" class="external-link">#1173</a>).</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.1" id="vctrs-031">vctrs 0.3.1<a class="anchor" aria-label="anchor" href="#vctrs-031"></a></h2><p class="text-muted">CRAN release: 2020-06-05</p>
<ul><li><p><code><a href="../reference/vec_slice.html">vec_slice()</a></code> no longer restores attributes of foreign objects for which a <code>[</code> method exist. This fixes an issue with <code>ts</code> objects which were previously incorrectly restored.</p></li>
<li><p>The <code><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list()</a></code> method for <code>vctrs_rcrd</code> objects has been removed in favor of directly using the method for <code>vctrs_vctr</code>, which calls <code><a href="../reference/vec_chop.html">vec_chop()</a></code>.</p></li>
<li><p><code><a href="../reference/vec_c.html">vec_c()</a></code> and <code><a href="../reference/vec_bind.html">vec_rbind()</a></code> now fall back to <code><a href="https://rdrr.io/r/base/c.html" class="external-link">base::c()</a></code> if the inputs have a common class hierarchy for which a <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> method is implemented but no self-to-self <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> method is implemented.</p></li>
<li><p><code><a href="../reference/vec_bind.html">vec_rbind()</a></code> now internally calls <code><a href="../reference/vec_proxy.html">vec_proxy()</a></code> and <code><a href="../reference/vec_proxy.html">vec_restore()</a></code> on the data frame common type that is used to create the output (<a href="https://github.com/r-lib/vctrs/issues/1109" class="external-link">#1109</a>).</p></li>
<li><p><code>vec_as_location2("0")</code> now works correctly (<a href="https://github.com/r-lib/vctrs/issues/1131" class="external-link">#1131</a>).</p></li>
<li><p><code>?reference-faq-compatibility</code> is a new reference guide on vctrs primitives. It includes an overview of the fallbacks to base R generics implemented in vctrs for compatibility with existing classes.</p></li>
<li><p>The documentation of vctrs functions now includes a Dependencies section to reference which other vctrs operations are called from that function. By following the dependencies links recursively, you will find the vctrs primitives on which an operation relies.</p></li>
</ul><div class="section level3">
<h3 id="cran-results-0-3-1">CRAN results<a class="anchor" aria-label="anchor" href="#cran-results-0-3-1"></a></h3>
<ul><li>Fixed type declaration mismatches revealed by LTO build.</li>
<li>Fixed r-devel issue with new <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">c.factor()</a></code> method.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.0" id="vctrs-030">vctrs 0.3.0<a class="anchor" aria-label="anchor" href="#vctrs-030"></a></h2><p class="text-muted">CRAN release: 2020-05-11</p>
<p>This version features an overhaul of the coercion system to make it more consistent and easier to implement. See the <em>Breaking changes</em> and <em>Type system</em> sections for details.</p>
<p>There are three new documentation topics if you’d like to learn how to implement coercion methods to make your class compatible with tidyverse packages like dplyr:</p>
<ul><li><p><a href="https://vctrs.r-lib.org/reference/theory-faq-coercion.html" class="uri">https://vctrs.r-lib.org/reference/theory-faq-coercion.html</a> for an overview of the coercion mechanism in vctrs.</p></li>
<li><p><a href="https://vctrs.r-lib.org/reference/howto-faq-coercion.html" class="uri">https://vctrs.r-lib.org/reference/howto-faq-coercion.html</a> for a practical guide about implementing methods for vectors.</p></li>
<li><p><a href="https://vctrs.r-lib.org/reference/howto-faq-coercion-data-frame.html" class="uri">https://vctrs.r-lib.org/reference/howto-faq-coercion-data-frame.html</a> for a practical guide about implementing methods for data frames.</p></li>
</ul><div class="section level3">
<h3 id="reverse-dependencies-troubleshooting-0-3-0">Reverse dependencies troubleshooting<a class="anchor" aria-label="anchor" href="#reverse-dependencies-troubleshooting-0-3-0"></a></h3>
<p>The following errors are caused by breaking changes.</p>
<ul><li>
<p><code>"Can't convert &lt;character&gt; to &lt;list&gt;."</code></p>
<p><code><a href="../reference/vec_cast.html">vec_cast()</a></code> no longer converts to list. Use <code><a href="../reference/vec_chop.html">vec_chop()</a></code> or <code><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list()</a></code> instead.</p>
</li>
<li>
<p><code>"Can't convert &lt;integer&gt; to &lt;character&gt;."</code></p>
<p><code><a href="../reference/vec_cast.html">vec_cast()</a></code> no longer converts to character. Use <code><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character()</a></code>to deparse objects.</p>
</li>
<li>
<p><code>"names for target but not for current"</code></p>
<p>Names of list-columns are now preserved by <code><a href="../reference/vec_bind.html">vec_rbind()</a></code>. Adjust tests accordingly.</p>
</li>
</ul></div>
<div class="section level3">
<h3 id="breaking-changes-0-3-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-3-0"></a></h3>
<ul><li>
<p>Double-dispatch methods for <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> and <code><a href="../reference/vec_cast.html">vec_cast()</a></code> are no longer inherited (<a href="https://github.com/r-lib/vctrs/issues/710" class="external-link">#710</a>). Class implementers must implement one set of methods for each compatible class.</p>
<p>For example, a tibble subclass no longer inherits from the <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> methods between <code>tbl_df</code> and <code>data.frame</code>. This means that you explicitly need to implement <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> methods with <code>tbl_df</code> and <code>data.frame</code>.</p>
<p>This change requires a bit more work from class maintainers but is safer because the coercion hierarchies are generally different from class hierarchies. See the S3 dispatch section of <code><a href="../reference/vec_ptype2.html">?vec_ptype2</a></code> for more information.</p>
</li>
<li>
<p><code><a href="../reference/vec_cast.html">vec_cast()</a></code> is now restricted to the same conversions as <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> methods (<a href="https://github.com/r-lib/vctrs/issues/606" class="external-link">#606</a>, <a href="https://github.com/r-lib/vctrs/issues/741" class="external-link">#741</a>). This change is motivated by safety and performance:</p>
<ul><li><p>It is generally sloppy to generically convert arbitrary inputs to one type. Restricted coercions are more predictable and allow your code to fail earlier when there is a type issue.</p></li>
<li><p>When unrestricted conversions are useful, this is generally towards a known type. For example, <code><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue::glue()</a></code> needs to convert arbitrary inputs to the known character type. In this case, using double dispatch instead of a single dispatch generic like <code><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character()</a></code> is wasteful.</p></li>
<li><p>To implement the useful semantics of coercible casts (already used in <code><a href="../reference/vec_slice.html">vec_assign()</a></code>), two double dispatch were needed. Now it can be done with one double dispatch by calling <code><a href="../reference/vec_cast.html">vec_cast()</a></code> directly.</p></li>
</ul></li>
<li><p><code><a href="../reference/vctrs-conditions.html">stop_incompatible_cast()</a></code> now throws an error of class <code>vctrs_error_incompatible_type</code> rather than <code>vctrs_error_incompatible_cast</code>. This means that <code><a href="../reference/vec_cast.html">vec_cast()</a></code> also throws errors of this class, which better aligns it with <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> now that they are restricted to the same conversions.</p></li>
<li><p>The <code>y</code> argument of <code><a href="../reference/vctrs-conditions.html">stop_incompatible_cast()</a></code> has been renamed to <code>to</code> to better match <code>to_arg</code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="type-system-0-3-0">Type system<a class="anchor" aria-label="anchor" href="#type-system-0-3-0"></a></h3>
<ul><li>
<p>Double-dispatch methods for <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> and <code><a href="../reference/vec_cast.html">vec_cast()</a></code> are now easier to implement. They no longer need any the boiler plate. Implementing a method for classes <code>foo</code> and <code>bar</code> is now as simple as:</p>
<pre><code><span><span class="co">#' @export</span></span>
<span><span class="va">vec_ptype2.foo.bar</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span> <span class="fu">new_foo</span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>vctrs also takes care of implementing the default and unspecified methods. If you have implemented these methods, they are no longer called and can now be removed.</p>
<p>One consequence of the new dispatch mechanism is that <code><a href="https://rdrr.io/r/base/UseMethod.html" class="external-link">NextMethod()</a></code> is now completely unsupported. This is for the best as it never worked correctly in a double-dispatch setting. Parent methods must now be called manually.</p>
</li>
<li><p><code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> methods now get zero-size prototypes as inputs. This guarantees that methods do not peek at the data to determine the richer type.</p></li>
<li><p><code><a href="../reference/vec_is_list.html">vec_is_list()</a></code> no longer allows S3 lists that implement a <code><a href="../reference/vec_proxy.html">vec_proxy()</a></code> method to automatically be considered lists. A S3 list must explicitly inherit from <code>"list"</code> in the base class to be considered a list.</p></li>
<li><p><code><a href="../reference/vec_proxy.html">vec_restore()</a></code> no longer restores row names if the target is not a data frame. This fixes an issue where <code>POSIXlt</code> objects would carry a <code>row.names</code> attribute after a proxy/restore roundtrip.</p></li>
<li><p><code><a href="../reference/vec_cast.html">vec_cast()</a></code> to and from data frames preserves the row names of inputs.</p></li>
<li>
<p>The internal function <code><a href="../reference/vec_names.html">vec_names()</a></code> now returns row names if the input is a data frame. Similarly, <code><a href="../reference/vec_names.html">vec_set_names()</a></code> sets row names on data frames. This is part of a general effort at making row names the vector names of data frames in vctrs.</p>
<p>If necessary, the row names are repaired verbosely but without error to make them unique. This should be a mostly harmless change for users, but it could break unit tests in packages if they make assumptions about the row names.</p>
</li>
</ul></div>
<div class="section level3">
<h3 id="compatibility-and-fallbacks-0-3-0">Compatibility and fallbacks<a class="anchor" aria-label="anchor" href="#compatibility-and-fallbacks-0-3-0"></a></h3>
<ul><li>
<p>With the double dispatch changes, the coercion methods are no longer inherited from parent classes. This is because the coercion hierarchy is in principle different from the S3 hierarchy. A consequence of this change is that subclasses that don’t implement coercion methods are now in principle incompatible.</p>
<p>This is particularly problematic with subclasses of data frames for which throwing incompatible errors would be too incovenient for users. To work around this, we have implemented a fallback to the relevant base data frame class (either <code>data.frame</code> or <code>tbl_df</code>) in coercion methods (<a href="https://github.com/r-lib/vctrs/issues/981" class="external-link">#981</a>). This fallback is silent unless you set the <code>vctrs:::warn_on_fallback</code> option to <code>TRUE</code>.</p>
<p>In the future we may extend this fallback principle to other base types when they are explicitly included in the class vector (such as <code>"list"</code>).</p>
</li>
<li>
<p>Improved support for foreign classes in the combining operations <code><a href="../reference/vec_c.html">vec_c()</a></code>, <code><a href="../reference/vec_bind.html">vec_rbind()</a></code>, and <code><a href="../reference/vec_unchop.html">vec_unchop()</a></code>. A foreign class is a class that doesn’t implement <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code>. When all the objects to combine have the same foreign class, one of these fallbacks is invoked:</p>
<ul><li><p>If the class implements a <code><a href="https://rdrr.io/r/base/c.html" class="external-link">base::c()</a></code> method, the method is used for the combination. (FIXME: <code><a href="../reference/vec_bind.html">vec_rbind()</a></code> currently doesn’t use this fallback.)</p></li>
<li><p>Otherwise if the objects have identical attributes and the same base type, we consider them to be compatible. The vectors are concatenated and the attributes are restored (<a href="https://github.com/r-lib/vctrs/issues/776" class="external-link">#776</a>).</p></li>
</ul><p>These fallbacks do not make your class completely compatible with vctrs-powered packages, but they should help in many simple cases.</p>
</li>
<li><p><code><a href="../reference/vec_c.html">vec_c()</a></code> and <code><a href="../reference/vec_unchop.html">vec_unchop()</a></code> now fall back to <code><a href="https://rdrr.io/r/base/c.html" class="external-link">base::c()</a></code> for S4 objects if the object doesn’t implement <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> but sets an S4 <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> method (<a href="https://github.com/r-lib/vctrs/issues/919" class="external-link">#919</a>).</p></li>
</ul></div>
<div class="section level3">
<h3 id="vector-operations-0-3-0">Vector operations<a class="anchor" aria-label="anchor" href="#vector-operations-0-3-0"></a></h3>
<ul><li><p><code><a href="../reference/vec_bind.html">vec_rbind()</a></code> and <code><a href="../reference/vec_c.html">vec_c()</a></code> with data frame inputs now consistently preserve the names of list-columns, df-columns, and matrix-columns (<a href="https://github.com/r-lib/vctrs/issues/689" class="external-link">#689</a>). This can cause some false positives in unit tests, if they are sensitive to internal names (<a href="https://github.com/r-lib/vctrs/issues/1007" class="external-link">#1007</a>).</p></li>
<li><p><code><a href="../reference/vec_bind.html">vec_rbind()</a></code> now repairs row names silently to avoid confusing messages when the row names are not informative and were not created on purpose.</p></li>
<li><p><code><a href="../reference/vec_bind.html">vec_rbind()</a></code> gains option to treat input names as row names. This is disabled by default (<a href="https://github.com/r-lib/vctrs/issues/966" class="external-link">#966</a>).</p></li>
<li><p>New <code><a href="../reference/vec-rep.html">vec_rep()</a></code> and <code><a href="../reference/vec-rep.html">vec_rep_each()</a></code> for repeating an entire vector and elements of a vector, respectively. These two functions provide a clearer interface for the functionality of <code><a href="../reference/vec_repeat.html">vec_repeat()</a></code>, which is now deprecated.</p></li>
<li>
<p><code><a href="../reference/vec_bind.html">vec_cbind()</a></code> now calls <code><a href="../reference/vec_proxy.html">vec_restore()</a></code> on inputs emptied of their columns before computing the common type. This has consequences for data frame classes with special columns that devolve into simpler classes when the columns are subsetted out. These classes are now always simplified by <code><a href="../reference/vec_bind.html">vec_cbind()</a></code>.</p>
<p>For instance, column-binding a grouped data frame with a data frame now produces a tibble (the simplified class of a grouped data frame).</p>
</li>
<li><p><code><a href="../reference/vec_match.html">vec_match()</a></code> and <code><a href="../reference/vec_match.html">vec_in()</a></code> gain parameters for argument tags (<a href="https://github.com/r-lib/vctrs/issues/944" class="external-link">#944</a>).</p></li>
<li><p>The internal version of <code><a href="../reference/vec_slice.html">vec_assign()</a></code> now has support for assigning names and inner names. For data frames, the names are assigned recursively.</p></li>
<li><p><code><a href="../reference/vec_slice.html">vec_assign()</a></code> gains <code>x_arg</code> and <code>value_arg</code> parameters (<a href="https://github.com/r-lib/vctrs/issues/918" class="external-link">#918</a>).</p></li>
<li><p><code><a href="../reference/vec_group.html">vec_group_loc()</a></code>, which powers <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">dplyr::group_by()</a></code>, now has more efficient vector access (<a href="https://github.com/r-lib/vctrs/issues/911" class="external-link">#911</a>).</p></li>
<li><p><code><a href="../reference/vec_ptype.html">vec_ptype()</a></code> gained an <code>x_arg</code> argument.</p></li>
<li><p>New <code><a href="../reference/vec_size.html">list_sizes()</a></code> for computing the size of every element in a list. <code><a href="../reference/vec_size.html">list_sizes()</a></code> is to <code><a href="../reference/vec_size.html">vec_size()</a></code> as <code><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths()</a></code> is to <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code>, except that it only supports lists. Atomic vectors and data frames result in an error.</p></li>
<li><p><code><a href="../reference/new_data_frame.html">new_data_frame()</a></code> infers size from row names when <code>n = NULL</code> (<a href="https://github.com/r-lib/vctrs/issues/894" class="external-link">#894</a>).</p></li>
<li><p><code><a href="../reference/vec_c.html">vec_c()</a></code> now accepts <code><a href="https://rlang.r-lib.org/reference/zap.html" class="external-link">rlang::zap()</a></code> as <code>.name_spec</code> input. The returned vector is then always unnamed, and the names do not cause errors when they can’t be combined. They are still used to create more informative messages when the inputs have incompatible types (<a href="https://github.com/r-lib/vctrs/issues/232" class="external-link">#232</a>).</p></li>
</ul></div>
<div class="section level3">
<h3 id="classes-0-3-0">Classes<a class="anchor" aria-label="anchor" href="#classes-0-3-0"></a></h3>
<ul><li><p>vctrs now supports the <code>data.table</code> class. The common type of a data frame and a data table is a data table.</p></li>
<li><p><code><a href="../reference/new_vctr.html">new_vctr()</a></code> now always appends a base <code>"list"</code> class to list <code>.data</code> to be compatible with changes to <code><a href="../reference/vec_is_list.html">vec_is_list()</a></code>. This affects <code><a href="../reference/new_list_of.html">new_list_of()</a></code>, which now returns an object with a base class of <code>"list"</code>.</p></li>
<li><p>dplyr methods are now implemented for <code><a href="../reference/vec_proxy.html">vec_restore()</a></code>, <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code>, and <code><a href="../reference/vec_cast.html">vec_cast()</a></code>. The user-visible consequence (and breaking change) is that row-binding a grouped data frame and a data frame or tibble now returns a grouped data frame. It would previously return a tibble.</p></li>
<li><p>The <code>is.na&lt;-()</code> method for <code>vctrs_vctr</code> now supports numeric and character subscripts to indicate where to insert missing values (<a href="https://github.com/r-lib/vctrs/issues/947" class="external-link">#947</a>).</p></li>
<li><p>Improved support for vector-like S4 objects (<a href="https://github.com/r-lib/vctrs/issues/550" class="external-link">#550</a>, <a href="https://github.com/r-lib/vctrs/issues/551" class="external-link">#551</a>).</p></li>
<li><p>The base classes <code>AsIs</code> and <code>table</code> have vctrs methods (<a href="https://github.com/r-lib/vctrs/issues/904" class="external-link">#904</a>, <a href="https://github.com/r-lib/vctrs/issues/906" class="external-link">#906</a>).</p></li>
<li><p><code>POSIXlt</code> and <code>POSIXct</code> vectors are handled more consistently (<a href="https://github.com/r-lib/vctrs/issues/901" class="external-link">#901</a>).</p></li>
<li><p>Ordered factors that do not have identical levels are now incompatible. They are now incompatible with all factors.</p></li>
</ul></div>
<div class="section level3">
<h3 id="indexing-and-names-0-3-0">Indexing and names<a class="anchor" aria-label="anchor" href="#indexing-and-names-0-3-0"></a></h3>
<ul><li><p><code><a href="../reference/vec_as_subscript.html">vec_as_subscript()</a></code> now fails when the subscript is a matrix or an array, consistently with <code><a href="../reference/vec_as_location.html">vec_as_location()</a></code>.</p></li>
<li><p>Improved error messages in <code><a href="../reference/vec_as_location.html">vec_as_location()</a></code> when subscript is a matrix or array (<a href="https://github.com/r-lib/vctrs/issues/936" class="external-link">#936</a>).</p></li>
<li><p><code><a href="../reference/vec_as_location.html">vec_as_location2()</a></code> properly picks up <code>subscript_arg</code> (tidyverse/tibble#735).</p></li>
<li><p><code><a href="../reference/vec_as_names.html">vec_as_names()</a></code> now has more informative error messages when names are not unique (<a href="https://github.com/r-lib/vctrs/issues/882" class="external-link">#882</a>).</p></li>
<li><p><code><a href="../reference/vec_as_names.html">vec_as_names()</a></code> gains a <code>repair_arg</code> argument that when set will cause <code>repair = "check_unique"</code> to generate an informative hint (<a href="https://github.com/r-lib/vctrs/issues/692" class="external-link">#692</a>).</p></li>
</ul></div>
<div class="section level3">
<h3 id="conditions-0-3-0">Conditions<a class="anchor" aria-label="anchor" href="#conditions-0-3-0"></a></h3>
<ul><li><p><code><a href="../reference/vctrs-conditions.html">stop_incompatible_type()</a></code> now has an <code>action</code> argument for customizing whether the coercion error came from <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> or <code><a href="../reference/vec_cast.html">vec_cast()</a></code>. <code><a href="../reference/vctrs-conditions.html">stop_incompatible_cast()</a></code> is now a thin wrapper around <code>stop_incompatible_type(action = "convert")</code>.</p></li>
<li><p><code>stop_</code> functions now take <code>details</code> after the dots. This argument can no longer be passed by position.</p></li>
<li><p>Supplying both <code>details</code> and <code>message</code> to the <code>stop_</code> functions is now an internal error.</p></li>
<li><p><code>x_arg</code>, <code>y_arg</code>, and <code>to_arg</code> are now compulsory arguments in <code>stop_</code> functions like <code><a href="../reference/vctrs-conditions.html">stop_incompatible_type()</a></code>.</p></li>
<li><p>Lossy cast errors are now considered internal. Please don’t test for the class or explicitly handle them.</p></li>
<li><p>New argument <code>loss_type</code> for the experimental function <code><a href="../reference/maybe_lossy_cast.html">maybe_lossy_cast()</a></code>. It can take the values “precision” or “generality” to indicate in the error message which kind of loss is the error about (double to integer loses precision, character to factor loses generality).</p></li>
<li><p>Coercion and recycling errors are now more consistent.</p></li>
</ul></div>
<div class="section level3">
<h3 id="cran-results-0-3-0">CRAN results<a class="anchor" aria-label="anchor" href="#cran-results-0-3-0"></a></h3>
<ul><li><p>Fixed clang-UBSAN error “nan is outside the range of representable values of type ‘int’” (<a href="https://github.com/r-lib/vctrs/issues/902" class="external-link">#902</a>).</p></li>
<li><p>Fixed compilation of stability vignette following the date conversion changes on R-devel.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.4" id="vctrs-024">vctrs 0.2.4<a class="anchor" aria-label="anchor" href="#vctrs-024"></a></h2><p class="text-muted">CRAN release: 2020-03-10</p>
<ul><li><p>Factors and dates methods are now implemented in C for efficiency.</p></li>
<li><p><code><a href="../reference/new_data_frame.html">new_data_frame()</a></code> now correctly updates attributes and supports merging of the <code>"names"</code> and <code>"row.names"</code> arguments (<a href="https://github.com/r-lib/vctrs/issues/883" class="external-link">#883</a>).</p></li>
<li><p><code><a href="../reference/vec_match.html">vec_match()</a></code> gains an <code>na_equal</code> argument (<a href="https://github.com/r-lib/vctrs/issues/718" class="external-link">#718</a>).</p></li>
<li><p><code><a href="../reference/vec_chop.html">vec_chop()</a></code>’s <code>indices</code> argument has been restricted to positive integer vectors. Character and logical subscripts haven’t proven useful, and this aligns <code><a href="../reference/vec_chop.html">vec_chop()</a></code> with <code><a href="../reference/vec_unchop.html">vec_unchop()</a></code>, for which only positive integer vectors make sense.</p></li>
<li><p>New <code><a href="../reference/vec_unchop.html">vec_unchop()</a></code> for combining a list of vectors into a single vector. It is similar to <code><a href="../reference/vec_c.html">vec_c()</a></code>, but gives greater control over how the elements are placed in the output through the use of a secondary <code>indices</code> argument.</p></li>
<li><p>Breaking change: When <code>.id</code> is supplied, <code><a href="../reference/vec_bind.html">vec_rbind()</a></code> now creates the identifier column at the start of the data frame rather than at the end.</p></li>
<li><p><code>numeric_version</code> and <code>package_version</code> lists are now treated as vectors (<a href="https://github.com/r-lib/vctrs/issues/723" class="external-link">#723</a>).</p></li>
<li><p><code><a href="../reference/vec_slice.html">vec_slice()</a></code> now properly handles symbols and S3 subscripts.</p></li>
<li><p><code><a href="../reference/vec_as_location.html">vec_as_location()</a></code> and <code><a href="../reference/vec_as_subscript.html">vec_as_subscript()</a></code> are now fully implemented in C for efficiency.</p></li>
<li><p><code><a href="../reference/vec_as_location.html">num_as_location()</a></code> gains a new argument, <code>zero</code>, for controlling whether to <code>"remove"</code>, <code>"ignore"</code>, or <code>"error"</code> on zero values (<a href="https://github.com/r-lib/vctrs/issues/852" class="external-link">#852</a>).</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.3" id="vctrs-023">vctrs 0.2.3<a class="anchor" aria-label="anchor" href="#vctrs-023"></a></h2><p class="text-muted">CRAN release: 2020-02-20</p>
<ul><li><p>The main feature of this release is considerable performance improvements with factors and dates.</p></li>
<li><p><code><a href="../reference/vec_c.html">vec_c()</a></code> now falls back to <code><a href="https://rdrr.io/r/base/c.html" class="external-link">base::c()</a></code> if the vector doesn’t implement <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> but implements <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>. This should improve the compatibility of vctrs-based functions with foreign classes (<a href="https://github.com/r-lib/vctrs/issues/801" class="external-link">#801</a>).</p></li>
<li><p><code><a href="../reference/new_data_frame.html">new_data_frame()</a></code> is now faster.</p></li>
<li><p>New <code><a href="../reference/vec_is_list.html">vec_is_list()</a></code> for detecting if a vector is a list in the vctrs sense. For instance, objects of class <code>lm</code> are not lists. In general, classes need to explicitly inherit from <code>"list"</code> to be considered as lists by vctrs.</p></li>
<li>
<p>Unspecified vectors of <code>NA</code> can now be assigned into a list (<a href="https://github.com/r-lib/vctrs/issues/819" class="external-link">#819</a>).</p>
<pre><code><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vec_slice.html">vec_slice</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; 2</span></span></code></pre>
</li>
<li><p><code><a href="../reference/vec_ptype.html">vec_ptype()</a></code> now errors on scalar inputs (<a href="https://github.com/r-lib/vctrs/issues/807" class="external-link">#807</a>).</p></li>
<li><p><code><a href="../reference/new_partial.html">vec_ptype_finalise()</a></code> is now recursive over all data frame types, ensuring that unspecified columns are correctly finalised to logical (<a href="https://github.com/r-lib/vctrs/issues/800" class="external-link">#800</a>).</p></li>
<li><p><code><a href="../reference/vec_ptype.html">vec_ptype()</a></code> now correctly handles unspecified columns in data frames, and will always return an unspecified column type (<a href="https://github.com/r-lib/vctrs/issues/800" class="external-link">#800</a>).</p></li>
<li><p><code><a href="../reference/vec_slice.html">vec_slice()</a></code> and <code><a href="../reference/vec_chop.html">vec_chop()</a></code> now work correctly with <code><a href="https://rdrr.io/pkg/bit64/man/bit64-package.html" class="external-link">bit64::integer64()</a></code> objects when an <code>NA</code> subscript is supplied. By extension, this means that <code><a href="../reference/vec_init.html">vec_init()</a></code> now works with these objects as well (<a href="https://github.com/r-lib/vctrs/issues/813" class="external-link">#813</a>).</p></li>
<li><p><code><a href="../reference/vec_bind.html">vec_rbind()</a></code> now binds row names. When named inputs are supplied and <code>names_to</code> is <code>NULL</code>, the names define row names. If <code>names_to</code> is supplied, they are assigned in the column name as before.</p></li>
<li><p><code><a href="../reference/vec_bind.html">vec_cbind()</a></code> now uses the row names of the first named input.</p></li>
<li><p>The <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> method for <code>vctrs_vctr</code> now throws an error when <code>recursive</code> or <code>use.names</code> is supplied (<a href="https://github.com/r-lib/vctrs/issues/791" class="external-link">#791</a>).</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.2" id="vctrs-022">vctrs 0.2.2<a class="anchor" aria-label="anchor" href="#vctrs-022"></a></h2><p class="text-muted">CRAN release: 2020-01-24</p>
<ul><li><p>New <code><a href="../reference/vec_as_subscript.html">vec_as_subscript()</a></code> function to cast inputs to the base type of a subscript (logical, numeric, or character). <code><a href="../reference/vec_as_index.html">vec_as_index()</a></code> has been renamed to <code><a href="../reference/vec_as_location.html">vec_as_location()</a></code>. Use <code><a href="../reference/vec_as_location.html">num_as_location()</a></code> if you need more options to control how numeric subscripts are converted to a vector of locations.</p></li>
<li><p>New <code><a href="../reference/vec_as_subscript.html">vec_as_subscript2()</a></code>, <code><a href="../reference/vec_as_location.html">vec_as_location2()</a></code>, and <code><a href="../reference/vec_as_location.html">num_as_location2()</a></code> variants for validating scalar subscripts and locations (e.g. for indexing with <code>[[</code>).</p></li>
<li><p><code><a href="../reference/vec_as_location.html">vec_as_location()</a></code> now preserves names of its inputs if possible.</p></li>
<li>
<p><code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> methods for base classes now prevent inheritance. This makes sense because the subtyping graph created by <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> methods is generally not the same as the inheritance relationships defined by S3 classes. For instance, subclasses are often a richer type than their superclasses, and should often be declared as supertypes (e.g. <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> should return the subclass).</p>
<p>We introduced this breaking change in a patch release because <code><a href="../reference/new_vctr.html">new_vctr()</a></code> now adds the base type to the class vector by default, which caused <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> to dispatch erroneously to the methods for base types. We’ll finish switching to this approach in vctrs 0.3.0 for the rest of the base S3 classes (dates, data frames, …).</p>
</li>
<li><p><code><a href="../reference/vec_equal.html">vec_equal_na()</a></code> now works with complex vectors.</p></li>
<li><p><code>vctrs_vctr</code> class gains an <code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt()</a></code> method (<a href="https://github.com/r-lib/vctrs/issues/717" class="external-link">#717</a>).</p></li>
<li><p><code><a href="../reference/vec_assert.html">vec_is()</a></code> now ignores names and row names (<a href="https://github.com/r-lib/vctrs/issues/707" class="external-link">#707</a>).</p></li>
<li><p><code><a href="../reference/vec_slice.html">vec_slice()</a></code> now support Altvec vectors (<a href="https://github.com/jimhester" class="external-link">@jimhester</a>, <a href="https://github.com/r-lib/vctrs/issues/696" class="external-link">#696</a>).</p></li>
<li><p><code><a href="../reference/vec_proxy_equal.html">vec_proxy_equal()</a></code> is now applied recursively across the columns of data frames (<a href="https://github.com/r-lib/vctrs/issues/641" class="external-link">#641</a>).</p></li>
<li><p><code><a href="../reference/vec_split.html">vec_split()</a></code> no longer returns the <code>val</code> column as a <code>list_of</code>. It is now returned as a bare list (<a href="https://github.com/r-lib/vctrs/issues/660" class="external-link">#660</a>).</p></li>
<li><p>Complex numbers are now coercible with integer and double (<a href="https://github.com/r-lib/vctrs/issues/564" class="external-link">#564</a>).</p></li>
<li><p>zeallot has been moved from Imports to Suggests, meaning that <code>%&lt;-%</code> is no longer re-exported from vctrs.</p></li>
<li><p><code><a href="../reference/vec_equal.html">vec_equal()</a></code> no longer propagates missing values when comparing list elements. This means that <code>vec_equal(list(NULL), list(NULL))</code> will continue to return <code>NA</code> because <code>NULL</code> is the missing element for a list, but now <code>vec_equal(list(NA), list(NA))</code> returns <code>TRUE</code> because the <code>NA</code> values are compared directly without checking for missingness.</p></li>
<li><p>Lists of expressions are now supported in <code><a href="../reference/vec_equal.html">vec_equal()</a></code> and functions that compare elements, such as <code><a href="../reference/vec_unique.html">vec_unique()</a></code> and <code><a href="../reference/vec_match.html">vec_match()</a></code>. This ensures that they work with the result of modeling functions like <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> and <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam()</a></code> which store “family” objects containing expressions (<a href="https://github.com/r-lib/vctrs/issues/643" class="external-link">#643</a>).</p></li>
<li><p><code><a href="../reference/new_vctr.html">new_vctr()</a></code> gains an experimental <code>inherit_base_type</code> argument which determines whether or not the class of the underlying type will be included in the class.</p></li>
<li><p><code><a href="../reference/list_of.html">list_of()</a></code> now inherits explicitly from “list” (<a href="https://github.com/r-lib/vctrs/issues/593" class="external-link">#593</a>).</p></li>
<li><p><code><a href="../reference/vec_ptype.html">vec_ptype()</a></code> has relaxed default behaviour for base types; now if two vectors both inherit from (e.g.) “character”, the common type is also “character” (<a href="https://github.com/r-lib/vctrs/issues/497" class="external-link">#497</a>).</p></li>
<li><p><code><a href="../reference/vec_equal.html">vec_equal()</a></code> now correctly treats <code>NULL</code> as the missing value element for lists (<a href="https://github.com/r-lib/vctrs/issues/653" class="external-link">#653</a>).</p></li>
<li><p><code><a href="../reference/vec_cast.html">vec_cast()</a></code> now casts data frames to lists rowwise, i.e. to a list of data frames of size 1. This preserves the invariant of <code>vec_size(vec_cast(x, to)) == vec_size(x)</code> (<a href="https://github.com/r-lib/vctrs/issues/639" class="external-link">#639</a>).</p></li>
<li><p>Positive and negative 0 are now considered equivalent by all functions that check for equality or uniqueness (<a href="https://github.com/r-lib/vctrs/issues/637" class="external-link">#637</a>).</p></li>
<li><p>New experimental functions <code><a href="../reference/vec_group.html">vec_group_rle()</a></code> for returning run length encoded groups; <code><a href="../reference/vec_group.html">vec_group_id()</a></code> for constructing group identifiers from a vector; <code><a href="../reference/vec_group.html">vec_group_loc()</a></code> for computing the locations of unique groups in a vector (<a href="https://github.com/r-lib/vctrs/issues/514" class="external-link">#514</a>).</p></li>
<li><p>New <code><a href="../reference/vec_chop.html">vec_chop()</a></code> for repeatedly slicing a vector. It efficiently captures the pattern of <code>map(indices, vec_slice, x = x)</code>.</p></li>
<li><p>Support for multiple character encodings has been added to functions that compare elements within a single vector, such as <code><a href="../reference/vec_unique.html">vec_unique()</a></code>, and across multiple vectors, such as <code><a href="../reference/vec_match.html">vec_match()</a></code>. When multiple encodings are encountered, a translation to UTF-8 is performed before any comparisons are made (<a href="https://github.com/r-lib/vctrs/issues/600" class="external-link">#600</a>, <a href="https://github.com/r-lib/vctrs/issues/553" class="external-link">#553</a>).</p></li>
<li><p>Equality and ordering methods are now implemented for raw and complex vectors (<a href="https://github.com/romainfrancois" class="external-link">@romainfrancois</a>).</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.1" id="vctrs-021">vctrs 0.2.1<a class="anchor" aria-label="anchor" href="#vctrs-021"></a></h2><p class="text-muted">CRAN release: 2019-12-17</p>
<p>Maintenance release for CRAN checks.</p>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.0" id="vctrs-020">vctrs 0.2.0<a class="anchor" aria-label="anchor" href="#vctrs-020"></a></h2><p class="text-muted">CRAN release: 2019-07-05</p>
<p>With the 0.2.0 release, many vctrs functions have been rewritten with native C code to improve performance. Functions like <code><a href="../reference/vec_c.html">vec_c()</a></code> and <code><a href="../reference/vec_bind.html">vec_rbind()</a></code> should now be fast enough to be used in packages. This is an ongoing effort, for instance the handling of factors and dates has not been rewritten yet. These classes still slow down vctrs primitives.</p>
<p>The API in 0.2.0 has been updated, please see a list of breaking changes below. vctrs has now graduated from experimental to a maturing package. Please note that API changes are still planned for future releases, for instance <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code> and <code><a href="../reference/vec_cast.html">vec_cast()</a></code> might need to return a sentinel instead of failing with an error when there is no common type or possible cast.</p>
<div class="section level3">
<h3 id="breaking-changes-0-2-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-2-0"></a></h3>
<ul><li><p>Lossy casts now throw errors of type <code>vctrs_error_cast_lossy</code>. Previously these were warnings. You can suppress these errors selectively with <code><a href="../reference/vctrs-conditions.html">allow_lossy_cast()</a></code> to get the partial cast results. To implement your own lossy cast operation, call the new exported function <code><a href="../reference/maybe_lossy_cast.html">maybe_lossy_cast()</a></code>.</p></li>
<li>
<p><code><a href="../reference/vec_c.html">vec_c()</a></code> now fails when an input is supplied with a name but has internal names or is length &gt; 1:</p>
<pre><code><span><span class="fu"><a href="../reference/vec_c.html">vec_c</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: Can't merge the outer name `foo` with a named vector.</span></span>
<span><span class="co">#&gt; Please supply a `.name_spec` specification.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/vec_c.html">vec_c</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: Can't merge the outer name `foo` with a vector of length &gt; 1.</span></span>
<span><span class="co">#&gt; Please supply a `.name_spec` specification.</span></span></code></pre>
<p>You can supply a name specification that describes how to combine the external name of the input with its internal names or positions:</p>
<pre><code><span><span class="co"># Name spec as glue string:</span></span>
<span><span class="fu"><a href="../reference/vec_c.html">vec_c</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, .name_spec <span class="op">=</span> <span class="st">"{outer}_{inner}"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Name spec as a function:</span></span>
<span><span class="fu"><a href="../reference/vec_c.html">vec_c</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, .name_spec <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">outer</span>, <span class="va">inner</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">outer</span>, <span class="va">inner</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vec_c.html">vec_c</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, .name_spec <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</li>
<li><p><code><a href="../reference/vec_empty.html">vec_empty()</a></code> has been renamed to <code><a href="../reference/vec_size.html">vec_is_empty()</a></code>.</p></li>
<li><p><code>vec_dim()</code> and <code>vec_dims()</code> are no longer exported.</p></li>
<li><p><code>vec_na()</code> has been renamed to <code><a href="../reference/vec_init.html">vec_init()</a></code>, as the primary use case is to initialize an output container.</p></li>
<li><p><code>vec_slice&lt;-</code> is now type stable (<a href="https://github.com/r-lib/vctrs/issues/140" class="external-link">#140</a>). It always returns the same type as the LHS. If needed, the RHS is cast to the correct type, but only if both inputs are coercible. See examples in <code><a href="../reference/vec_slice.html">?vec_slice</a></code>.</p></li>
<li>
<p>We have renamed the <code>type</code> particle to <code>ptype</code>:</p>
<ul><li>
<code><a href="../reference/vec_type.html">vec_type()</a></code> =&gt; <code><a href="../reference/vec_ptype.html">vec_ptype()</a></code>
</li>
<li>
<code><a href="../reference/vec_type.html">vec_type2()</a></code> =&gt; <code><a href="../reference/vec_ptype2.html">vec_ptype2()</a></code>
</li>
<li>
<code><a href="../reference/vec_type.html">vec_type_common()</a></code> =&gt; <code><a href="../reference/vec_ptype.html">vec_ptype_common()</a></code>
</li>
</ul><p>Consequently, <code><a href="../reference/vec_ptype.html">vec_ptype()</a></code> was renamed to <code><a href="../reference/vec_ptype.html">vec_ptype_show()</a></code>.</p>
</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-2-0">New features<a class="anchor" aria-label="anchor" href="#new-features-0-2-0"></a></h3>
<ul><li>
<p>New <code><a href="../reference/vec_proxy.html">vec_proxy()</a></code> generic. This is the main customisation point in vctrs along with <code><a href="../reference/vec_proxy.html">vec_restore()</a></code>. You should only implement it when your type is designed around a non-vector class (atomic vectors, bare lists, data frames). In this case, <code><a href="../reference/vec_proxy.html">vec_proxy()</a></code> should return such a vector class. The vctrs operations will be applied on the proxy and <code><a href="../reference/vec_proxy.html">vec_restore()</a></code> is called to restore the original representation of your type.</p>
<p>The most common case where you need to implement <code><a href="../reference/vec_proxy.html">vec_proxy()</a></code> is for S3 lists. In vctrs, S3 lists are treated as scalars by default. This way we don’t treat objects like model fits as vectors. To prevent vctrs from treating your S3 list as a scalar, unclass it from the <code><a href="../reference/vec_proxy.html">vec_proxy()</a></code> method. For instance here is the definition for <code>list_of</code>:</p>
<pre><code><span><span class="co">#' @export</span></span>
<span><span class="va">vec_proxy.vctrs_list_of</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
<p>If you inherit from <code>vctrs_vctr</code> or <code>vctrs_rcrd</code> you don’t need to implement <code><a href="../reference/vec_proxy.html">vec_proxy()</a></code>.</p>
</li>
<li><p><code><a href="../reference/vec_c.html">vec_c()</a></code>, <code><a href="../reference/vec_bind.html">vec_rbind()</a></code>, and <code><a href="../reference/vec_bind.html">vec_cbind()</a></code> gain a <code>.name_repair</code> argument (<a href="https://github.com/r-lib/vctrs/issues/227" class="external-link">#227</a>, <a href="https://github.com/r-lib/vctrs/issues/229" class="external-link">#229</a>).</p></li>
<li>
<p><code><a href="../reference/vec_c.html">vec_c()</a></code>, <code><a href="../reference/vec_bind.html">vec_rbind()</a></code>, <code><a href="../reference/vec_bind.html">vec_cbind()</a></code>, and all functions relying on <code><a href="../reference/vec_ptype.html">vec_ptype_common()</a></code> now have more informative error messages when some of the inputs have nested data frames that are not convergent:</p>
<pre><code><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>bar <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>bar <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/vec_bind.html">vec_rbind</a></span><span class="op">(</span><span class="va">df1</span>, <span class="va">df2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: No common type for `..1$foo$bar$y` &lt;character&gt; and `..2$foo$bar$y` &lt;integer&gt;.</span></span></code></pre>
</li>
<li>
<p><code><a href="../reference/vec_bind.html">vec_cbind()</a></code> now turns named data frames to packed columns.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">vec_cbind</span>(data, <span class="at">packed =</span> data)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>data</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 3 x 3</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>      x y     packed<span class="sc">$</span>x <span class="sc">$</span>y</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="dv">1</span> a            <span class="dv">1</span> a</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     <span class="dv">2</span> b            <span class="dv">2</span> b</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     <span class="dv">3</span> c            <span class="dv">3</span> c</span></code></pre></div>
<p>Packed data frames are nested in a single column. This makes it possible to access it through a single name:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>packed</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 3 x 2</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>      x y</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="dv">1</span> a</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     <span class="dv">2</span> b</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     <span class="dv">3</span> c</span></code></pre></div>
<p>We are planning to use this syntax more widely in the tidyverse.</p>
</li>
<li>
<p>New <code><a href="../reference/vec_assert.html">vec_is()</a></code> function to check whether a vector conforms to a prototype and/or a size. Unlike <code><a href="../reference/vec_assert.html">vec_assert()</a></code>, it doesn’t throw errors but returns <code>TRUE</code> or <code>FALSE</code> (<a href="https://github.com/r-lib/vctrs/issues/79" class="external-link">#79</a>).</p>
<p>Called without a specific type or size, <code><a href="../reference/vec_assert.html">vec_assert()</a></code> tests whether an object is a data vector or a scalar. S3 lists are treated as scalars by default. Implement a <code>vec_is_vector()</code> for your class to override this property (or derive from <code>vctrs_vctr</code>).</p>
</li>
<li><p>New <code><a href="../reference/vec_order.html">vec_order()</a></code> and <code><a href="../reference/vec_order.html">vec_sort()</a></code> for ordering and sorting generalised vectors.</p></li>
<li><p>New <code>.names_to</code> parameter for <code><a href="../reference/vec_bind.html">vec_rbind()</a></code>. If supplied, this should be the name of a column where the names of the inputs are copied. This is similar to the <code>.id</code> parameter of <code><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">dplyr::bind_rows()</a></code>.</p></li>
<li><p>New <code><a href="../reference/vec_seq_along.html">vec_seq_along()</a></code> and <code><a href="../reference/vec_seq_along.html">vec_init_along()</a></code> create useful sequences (<a href="https://github.com/r-lib/vctrs/issues/189" class="external-link">#189</a>).</p></li>
<li><p><code><a href="../reference/vec_slice.html">vec_slice()</a></code> now preserves character row names, if present.</p></li>
<li><p>New <code>vec_split(x, by)</code> is a generalisation of <code><a href="https://rdrr.io/r/base/split.html" class="external-link">split()</a></code> that can divide a vector into groups formed by the unique values of another vector. Returns a two-column data frame containing unique values of <code>by</code> aligned with matching <code>x</code> values (<a href="https://github.com/r-lib/vctrs/issues/196" class="external-link">#196</a>).</p></li>
</ul></div>
<div class="section level3">
<h3 id="other-features-and-bug-fixes-0-2-0">Other features and bug fixes<a class="anchor" aria-label="anchor" href="#other-features-and-bug-fixes-0-2-0"></a></h3>
<ul><li><p>Using classed errors of class <code>"vctrs_error_assert"</code> for failed assertions, and of class <code>"vctrs_error_incompatible"</code> (with subclasses <code>_type</code>, <code>_cast</code> and <code>_op</code>) for errors on incompatible types (<a href="https://github.com/r-lib/vctrs/issues/184" class="external-link">#184</a>).</p></li>
<li><p>Character indexing is now only supported for named objects, an error is raised for unnamed objects (<a href="https://github.com/r-lib/vctrs/issues/171" class="external-link">#171</a>).</p></li>
<li><p>Predicate generics now consistently return logical vectors when passed a <code>vctrs_vctr</code> class. They used to restore the output to their input type (<a href="https://github.com/r-lib/vctrs/issues/251" class="external-link">#251</a>).</p></li>
<li><p><code><a href="../reference/list_of.html">list_of()</a></code> now has an <code><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character()</a></code> method. It uses <code><a href="../reference/vec_ptype_full.html">vec_ptype_abbr()</a></code> to collapse complex objects into their type representation (tidyverse/tidyr#654).</p></li>
<li><p>New <code><a href="../reference/vctrs-conditions.html">stop_incompatible_size()</a></code> to signal a failure due to mismatched sizes.</p></li>
<li><p>New <code><a href="../reference/list_of.html">validate_list_of()</a></code> (<a href="https://github.com/r-lib/vctrs/issues/193" class="external-link">#193</a>).</p></li>
<li><p><code><a href="../reference/vec_arith.html">vec_arith()</a></code> is consistent with base R when combining <code>difftime</code> and <code>date</code>, with a warning if casts are lossy (<a href="https://github.com/r-lib/vctrs/issues/192" class="external-link">#192</a>).</p></li>
<li><p><code><a href="../reference/vec_c.html">vec_c()</a></code> and <code><a href="../reference/vec_bind.html">vec_rbind()</a></code> now handle data.frame columns properly (<a href="https://github.com/yutannihilation" class="external-link">@yutannihilation</a>, <a href="https://github.com/r-lib/vctrs/issues/182" class="external-link">#182</a>).</p></li>
<li><p><code>vec_cast(x, data.frame())</code> preserves the number of rows in <code>x</code>.</p></li>
<li><p><code><a href="../reference/vec_equal.html">vec_equal()</a></code> now handles missing values symmetrically (<a href="https://github.com/r-lib/vctrs/issues/204" class="external-link">#204</a>).</p></li>
<li><p><code><a href="../reference/vec_equal.html">vec_equal_na()</a></code> now returns <code>TRUE</code> for data frames and records when every component is missing, not when <em>any</em> component is missing (<a href="https://github.com/r-lib/vctrs/issues/201" class="external-link">#201</a>).</p></li>
<li><p><code><a href="../reference/vec_init.html">vec_init()</a></code> checks input is a vector.</p></li>
<li><p><code><a href="../reference/vec_proxy_compare.html">vec_proxy_compare()</a></code> gains an experimental <code>relax</code> argument, which allows data frames to be orderable even if all their columns are not (<a href="https://github.com/r-lib/vctrs/issues/210" class="external-link">#210</a>).</p></li>
<li><p><code><a href="../reference/vec_size.html">vec_size()</a></code> now works with positive short row names. This fixes issues with data frames created with jsonlite (<a href="https://github.com/r-lib/vctrs/issues/220" class="external-link">#220</a>).</p></li>
<li><p><code>vec_slice&lt;-</code> now has a <code><a href="../reference/vec_slice.html">vec_assign()</a></code> alias. Use <code><a href="../reference/vec_slice.html">vec_assign()</a></code> when you don’t want to modify the original input.</p></li>
<li><p><code><a href="../reference/vec_slice.html">vec_slice()</a></code> now calls <code><a href="../reference/vec_proxy.html">vec_restore()</a></code> automatically. Unlike the default <code>[</code> method from base R, attributes are preserved by default.</p></li>
<li><p><code><a href="../reference/vec_slice.html">vec_slice()</a></code> can correct slice 0-row data frames (<a href="https://github.com/r-lib/vctrs/issues/179" class="external-link">#179</a>).</p></li>
<li><p>New <code><a href="../reference/vec_repeat.html">vec_repeat()</a></code> for repeating each element of a vector the same number of times.</p></li>
<li><p><code>vec_type2(x, data.frame())</code> ensures that the returned object has names that are a length-0 character vector.</p></li>
</ul></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="http://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://github.com/lionel-" class="external-link">Lionel Henry</a>, <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

  </div></footer></body></html>

